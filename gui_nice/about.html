<h3>About Dual-Pool Mining Proxy (DPMP)</h3>
<p><strong>DPMP </strong>&nbsp;is a lightweight, high-reliability&nbsp;<strong>Stratum v1 mining
        proxy</strong>&nbsp;designed to sit between one or more miners and&nbsp;two upstream mining pools. It was
    designed primarily for Bitcoin solo-miners who run one or more ASIC miners (SHA-256) and want to split hash power
    across compatible coins/pools (i.e., BTC/BCH/DGB). Some miners, like the NerdQAxe++, have a built-in "dual pool
    mining" feature but the majority of miners out there do not.</p>
<p>So if you have one or more miners that do NOT have a built-in dual-pool mining feature (such as the Canaan Avalon Q
    or the Nano3S) and you would like, for example, to mine to a BTC pool and a Bitcoin Cash pool simultaneously, then
    <strong>DPMP</strong> is for you.&nbsp;
</p>
<p><strong>DPMP</strong> enables&nbsp;<strong>deterministic dual-pool scheduling</strong>, advanced
    difficulty/extranonce handling, and observability via Prometheus metrics &mdash; while remaining simple to deploy
    and operate.</p>
<p dir="auto">At a high level, <strong>DPMP</strong>:</p>
<ul dir="auto">
    <li>Accepts Stratum connections from miners (acts like a pool)</li>
    <li>Maintains concurrent Stratum connections to&nbsp;<strong>two upstream pools</strong>&nbsp;(acts like a miner)
    </li>
    <li>Routes jobs and share submissions according to a&nbsp;<strong>scheduler</strong> with manual or auto-balancing
    </li>
    <li>Ensures correct propagation of:
        <ul dir="auto">
            <li>difficulty</li>
            <li>extranonce</li>
            <li>job IDs</li>
        </ul>
    </li>
    <li>Exposes runtime metrics for monitoring and analysis</li>
    <li>Logs structured, machine-readable events for debugging and auditing</li>
</ul>
<p dir="auto">The proxy is intentionally&nbsp;<strong>transparent</strong>: miners and pools do not need to be modified
    or aware that <strong>DPMP</strong> is in the middle.</p>
<hr />
<h4 dir="auto">Configuration and Setup</h4>
<p dir="auto">When <strong>DPMP</strong> first starts, you will need to go to the <em>Config</em>&nbsp;tab to edit the
    <strong>pools</strong> section and, for both pools, put in the URL/IP Address, Port, and the wallet address to be
    used when mining to that pool (make sure the wallet address is correct!) You can also give&nbsp;the pool a
    name.&nbsp;
</p>
<p dir="auto">By detault, the work will be split 50/50 between the two pools. You can adjust the weighting in the
    <strong>scheduler</strong> section (i.e., perhaps 70/30, or 90/10...whatever you like).
</p>
<p dir="auto">Once you make the configuration changes, click the <strong>APPLY + RESTART</strong> button and
    <strong>DPMP</strong> will restart. When it does, check the <em>Home</em> tab and make sure you see:
    <strong>DPMP</strong>: running.
</p>
<p dir="auto">Now, for each miner you want to use with the proxy, set up the miner's Pool URL to point to the IP address
    of the box on which you are running the <strong>DPMP</strong> proxy, set the Port to 3351, and put in one of your
    wallet addresses, a period, and finally the workername (i.e., &lt;wallet address&gt;.&lt;workername&gt;)</p>
<p dir="auto">Please note that the wallet address you input in the miner is <strong>NOT</strong> used by the
    proxy...only the workername is used. The proxy gets the correct wallet address to use for each pool from the
    <strong>DPMP</strong> Configuration file, and when it communicates with either pool it uses the correct wallet
    address for that pool. So, for example, if you are setting up <strong>DPMP</strong> to mine to a regular Bitcoin
    pool and to a Bitcoin Cash pool, in your miner config use either your Bitcoin wallet address or your Bitcoin Cash
    wallet address (does not matter which) and then append the workername to the end as shown above.
</p>
<p dir="auto">Once your miners are configured and restarted, check the <em>Home</em> tab and you should see the correct
    number of miners connected, and the Accepted, Rejected, and Jobs stats should be updating. You should also see your
    miner(s) show up on your pool dashboards.&nbsp;</p>
<p dir="auto"><strong>Note</strong>: When using <strong>DPMP</strong>, it&nbsp;is normal for the Rejection Rate reported
    in your miner dashboard to be a bit higher than usual, and this is because switching between pools introduces some
    <em>job not found</em> as well as some&nbsp;<em>stale job</em> conditions. Again, this is normal and nothing to be
    worried about.
</p>
<hr />
<p dir="auto"><strong>DPMP</strong> currently balances Pool A and Pool B using a time-sliced scheduler with sticky
    intervals, meaning only one pool is active at a time and receives all forwarded jobs for a fixed slice duration
    before switching. This approach was chosen because Stratum miners cannot safely split work across multiple pools
    concurrently without causing extranonce collisions, stale jobs, or high reject rates; serializing work per slice
    preserves protocol correctness while still achieving long-term fairness.</p>
<p dir="auto">Because pools may assign very different difficulties (especially at startup or under VarDiff), job count
    or share count alone is misleading when evaluating balance. Instead, the most reliable metric is "total accepted
    difficulty" (<strong>SumDiff</strong> on the Home page), which measures the actual amount of valid proof-of-work
    accepted by each pool. Difficulty-weighted acceptance normalizes across VarDiff, startup difficulty ramps, and
    pool-specific policies, making it the closest proxy to real hashpower contribution. When <strong>DPMP</strong> is
    configured correctly, the accepted difficulty totals for Pool A and Pool B converge toward the configured ratio over
    time—even if job counts or raw share counts appear skewed in the short term.</p>
<p dir="auto">If you want to play around with the intervals, you can adjust the "Min Switch Seconds" (recommend between
    50 and 120) as well as "Slice Seconds" (recommend between 30 and 70) in the <b>scheduler</b> section on the
    Configuration tab. As a rule, "Slice Seconds" should always be about 60% of "Min Switch Seconds". The default values
    are "Min Switch Seconds" = 50 and "Slice Seconds" = 30.</p>
<p dir="auto"><strong>Note</strong>: For high-hashrate miners (>100 TH/s), consider increasing Min Switch to 90 and
    Slice to 60 to reduce rejects during pool transitions. This will be less of an issue at the default 50/50 weighting
    but can become an issue at more lopsided weightings such as 15/85 or 85/15, etc.</p>
<hr />
<p dir="auto"><strong>Dynamic Hashrate Allocation</strong>: with the slider on the Home tab, you can adjust the hashrate
    allocation (weighting) in realtime with no restart required. Just drag the slider to the desired position and
    <strong>DPMP</strong> will adjust accordingly. Some limitations do apply. The slider ranges from 5% to 95% so you
    cannot allocate 100% of the hashrate to one pool or the other. If you DO want either 0/100 or 100/0 weightings, you
    must set that in the <strong>scheduler</strong> section on the Configuration tab and restart <strong>DPMP</strong>.
    And if your weighting is set to either 0/100 or 100/0, the <strong>Hashrate Allocation</strong> slider will no
    longer appear on the Home tab. Bottom line, though, if you need to temporarily move some hashrate from one pool to
    the other, the <strong>Hashrate Allocation</strong> slider is the best way to do that.
</p>
<hr />
<p dir="auto"><strong>Auto-Balancing</strong>: if you enable the "Auto Balance" feature in the
    <strong>scheduler</strong> section on the Configuration tab, <strong>DPMP</strong> will automatically adjust the
    pool weighting ratio periodically based on the observed realtime network hashrate of the coin associated with each
    pool. The default pool ratio when in "Auto-Balancet" mode is 50/50 and it adjusts from there. The goal of this
    feature is to send more hashrate to the pool where our hashrate has more "value". So, for example, if BTC short-term
    network hashrate increases relative to its long-term hashrate while BCH hashrate decreases then
    <strong>DPMP</strong> will automatically adjust the weighting to send more hashrate to BCH and less to BTC.
</p>
<p dir="auto">The hashrate information is obtained by polling an oracle API endpoint at regular intervals (default is
    every 10 minutes) and the oracle data is used to calculate the optimal pool weighting ratio based on the relative
    hashrate changes. The oracle URL, poll interval, and max deviation threshold can all be configured in the
    <strong>scheduler</strong> section on the Configuration tab. When the Auto-Balancer feature is enabled, the
    <strong>Hashrate Allocation</strong> slider on the Home tab will no longer be visible since the pool weighting will
    be automatically managed by <strong>DPMP</strong>. In its place a new panel will appear showing the current
    oracle-based pool weighting ratio as well as the realtime network hashrate for each pool. You can also see the
    oracle data in the Prometheus metrics (ORACLE_HASHRATE, ORACLE_RATIO, ORACLE_WEIGHT, ORACLE_STATUS, and ORACLE_AGE).
</p>
<p dir="auto">Now, our "baseline" network hashrate calculation tracks closely with what you'd see on hashrate reporting
    sites (e.g., CoinWarz), while the short-term window deliberately captures block-to-block variance to detect
    transient hashrate shifts — the Auto-Balancer acts on the ratio between the two, not the raw numbers. </p>
<p dir="auto">Some limitations do apply. Currently, we only support BTC and BCH pools. In the Pool A and B sections of
    your configuration file you must specify a chain name for each pool (e.g., "btc" or "bch"). We also limit the max
    deviation threshold to between 5 and 45. So with a setting of 5 the Auto-Balancer will never move beyond a 45/55 -
    55/45 ratio. With a max deviation threshold of 45, the Auto-Balancer will never move beyond a 5/95 - 95/5 ratio. The
    default max deviation value is 20, so the Auto-Balancer will never move beyond 30/70 - 70/30.</p>
<hr />
<p dir="auto"><strong>DPMP</strong> has pool failover protection implemented as follows: if you are splitting work
    between pools A and B (i.e., pool weighting ratio is NOT 0/100 or 100/0) then if either pool fails, all work (100%)
    will be routed to the pool that is still active. When the inactive pool becomes available again, the original
    weighting logic will resume. If BOTH pools become unavailable, <strong>DPMP</strong> will simply wait until one or
    both pools become available again and, during this time, it will maintain a connection with any miners attached. If
    you are currently routing to only one pool (i.e., pool weighting is 0/100 or 100/0) then if the active pool becomes
    unavailable, <strong>DPMP</strong> will simply wait until the pool becomes available again...in this situation it
    will NOT route any work to the pool with the 0 weighting.</p>
<hr />
<p dir="auto"></p>If you encounter errors associated either with a particular miner or a particular pool:</p>

<ul>
    <li>Please make sure that all events are being logged on the Config tab</li>
    <li>Click <strong>APPLY + RESTART</strong> to restart <strong>DPMP</strong> and recreate the error</li>
    <li>Click on the <strong>Download Log</strong> button on the Logs tab</li>
    <li>Send a description of the problem (i.e., miner-related or pool-related and identify the miner or pool) to <a
            href="mailto:dpmp.project@gmail.com">dpmp.project@gmail.com</a> and attach the log file.</li>
</ul>

<p dir="auto">We have tested <strong>DPMP</strong> with a number of different miners and pools but it is by no means an
    exhaustive
    list. The log data you provide will help us to expand the list of supported miners and pools.</p>

<hr />
<p>If you would like to support the <b>DPMP</b> project, please consider a donation to either of the following
    addresses:</p>
<p>Bitcoin (BTC): <strong>bc1q9qrn7lsdnpy8w33dsdnu6cr4jdpg53zexgxh59</strong></p>
<p>Bitcoin Cash (BCH): <strong>bitcoincash:qqlldmmc978u5u7uzas8cakxgfftraquxvjhcc8a3q</strong></p>
<hr />
<p dir="auto">Questions or Comments? Contact us at: <a
        href="mailto:dpmp.project@gmail.com"><strong>dpmp.project@gmail.com</strong></a>
    <hr />
<p dir="auto"><b>Note</b>: This dashboard was built using <a href="https://nicegui.io/" target="_blank"
        rel="noopener noreferrer"><b>NiceGUI</b></a>.</p>
<p>&nbsp;</p>